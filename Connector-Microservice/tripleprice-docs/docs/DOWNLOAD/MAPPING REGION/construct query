CREATE TABLE IF NOT EXISTS T_MAPPING_CITIES  ENCODING  'latin1' (
		
  id serial NOT NULL,
  region_id int  NOT NULL,
  country_id smallint  NOT NULL,
  latitude double precision NOT NULL,
  longitude double precision NOT NULL,
  name varchar NOT NULL,
  PRIMARY KEY (id),
  KEY country_region_name (country_id,region_id,name)
)   


CREATE DATABASE tripleprice WITH ENCODING 'LATIN1' LC_COLLATE='C'
     LC_CTYPE='C' TEMPLATE=template0;

"Radovi"
SELECT * FROM T_MST_LOCATION WHERE location_alpha_code LIKE 'JT'
SELECT * FROM T_MST_LOCATION WHERE name_en = 'Jawa tengah'

/* 
INSERT INTO T_MST_LOCATION (
parent_id,location_numeric_code,location_alpha_code,
location_type,name_en,created_on,created_by,
updated_on,updated_by,version, description )
*/
SELECT 
cast((SELECT ID AS A FROM t_mst_location WHERE LOCATION_ALPHA_CODE = TMP.ID_COUNTRY AND LOCATION_TYPE = 3) as INTEGER) as parent_id,
-1 LOCATION_NUMERIC_CODE,
LOCAL_CONDE AS LOCATION_ALPHA_CODE, 
 CAST ( CASE 	WHEN TYPE_COUNTY =  'Administration' OR TYPE_COUNTY = 'Administrative atoll' OR TYPE_COUNTY = 'Administrative region' OR TYPE_COUNTY = 'Administrative territory' THEN '4'
	WHEN TYPE_COUNTY =  'Arctic region' THEN '5'
	WHEN TYPE_COUNTY =  'Area' THEN '6'
	WHEN TYPE_COUNTY =  'Autonomous city' OR TYPE_COUNTY = 'Autonomous city in North Africa' OR TYPE_COUNTY = 'autonomous district' OR TYPE_COUNTY = 'Autonomous district' OR TYPE_COUNTY = 'Autonomous municipality' or
	TYPE_COUNTY = 'Autonomous province' OR TYPE_COUNTY = 'autonomous region' OR TYPE_COUNTY = 'Autonomous region' OR TYPE_COUNTY = 'Autonomous Region' OR TYPE_COUNTY = 'Autonomous republic' OR TYPE_COUNTY = 'Autonomous sector' or
	TYPE_COUNTY = 'Autonomous territory unit' THEN '7'
	WHEN TYPE_COUNTY =  'canton' or TYPE_COUNTY = 'Canton' THEN '8'
	WHEN TYPE_COUNTY =  'Capital' OR TYPE_COUNTY = 'Capital city' or TYPE_COUNTY = 'Capital City' OR TYPE_COUNTY = 'Capital district' OR TYPE_COUNTY = 'Capital territory' THEN '9'
	WHEN TYPE_COUNTY =  'Chains (of islands)' THEN '10'
	WHEN TYPE_COUNTY =  'city'  or TYPE_COUNTY = 'City' OR TYPE_COUNTY = 'City Corporation' OR TYPE_COUNTY = 'City municipality' OR TYPE_COUNTY = 'City with county rights' THEN '11'
	WHEN TYPE_COUNTY =  'Commune' THEN '12'
	WHEN TYPE_COUNTY =  'Council area' THEN '13'
	WHEN TYPE_COUNTY =  'County' THEN '14'
	WHEN TYPE_COUNTY =  'Department' OR TYPE_COUNTY = ' Department' or TYPE_COUNTY = 'Departments' THEN '15'
	WHEN TYPE_COUNTY =  'Dependency' THEN '16'
	WHEN TYPE_COUNTY =  'district' OR TYPE_COUNTY = 'District' OR TYPE_COUNTY = 'District council area' OR TYPE_COUNTY = 'District municipality' OR TYPE_COUNTY = 'districts under republic administration' 
	or TYPE_COUNTY = 'District with special' OR TYPE_COUNTY = 'status' THEN '17'
	WHEN TYPE_COUNTY =  'Division' THEN '18'
	WHEN TYPE_COUNTY =  'economic prefecture' THEN '19'
	WHEN TYPE_COUNTY =  'Emirate' THEN '20'
	WHEN TYPE_COUNTY =  'Entity' THEN '21'
	WHEN TYPE_COUNTY =  'Federal capital territory' OR TYPE_COUNTY = 'Federal dependencies'  OR TYPE_COUNTY = 'Federal district' or TYPE_COUNTY = 'Federal District' OR TYPE_COUNTY = 'Federal territory' THEN '22'
	WHEN TYPE_COUNTY =  'Geographical entity' THEN '23'
	WHEN TYPE_COUNTY =  'Governorat' or TYPE_COUNTY = 'governorate' or TYPE_COUNTY = 'Governorate' THEN '24'
	WHEN TYPE_COUNTY =  'Group of islands' THEN '25'
	WHEN TYPE_COUNTY =  'indigenous region' THEN '26'
	WHEN TYPE_COUNTY =  'Island' OR TYPE_COUNTY = 'Island council' OR TYPE_COUNTY = 'Islands/Groups of Islands' THEN '27'
	WHEN TYPE_COUNTY =  'Land' THEN '28'
	WHEN TYPE_COUNTY =  'Local council' THEN '29'
	WHEN TYPE_COUNTY =  'London borough' THEN '30'
	WHEN TYPE_COUNTY =  'Metropolitan administration' OR TYPE_COUNTY = 'Metropolitan city' or TYPE_COUNTY = 'Metropolitan City' OR TYPE_COUNTY = 'Metropolitan department' THEN '31'
	WHEN TYPE_COUNTY =  'municipality' or TYPE_COUNTY = 'Municipality' THEN '32'
	WHEN TYPE_COUNTY =  'Oblast' THEN '33'
	WHEN TYPE_COUNTY =  'Outlying area' THEN '34'
	WHEN TYPE_COUNTY =  'Pakistan administrered area' THEN '35'
	WHEN TYPE_COUNTY =  'Parish' THEN '36'
	WHEN TYPE_COUNTY =  'Partish' THEN '37'
	WHEN TYPE_COUNTY =  'Popularate' THEN '38'
	WHEN TYPE_COUNTY =  'Prefecture' THEN '39'
	WHEN TYPE_COUNTY =  'Provicne' or TYPE_COUNTY = 'province' or TYPE_COUNTY = 'Province' THEN '40'
	WHEN TYPE_COUNTY =  'Quarter' THEN '41'
	WHEN TYPE_COUNTY =  'Rayon' THEN '42'
	WHEN TYPE_COUNTY =  'region' or TYPE_COUNTY = 'Region' THEN '43'
	WHEN TYPE_COUNTY =  'Republic' OR TYPE_COUNTY = 'Republican city' THEN '44'
	WHEN TYPE_COUNTY =  'Special administrative region' or TYPE_COUNTY LIKE '%special administrative%' or TYPE_COUNTY = 'Special Administrative Region' or TYPE_COUNTY = 'special administrative' OR TYPE_COUNTY = 'Special administrative city'  THEN '76'
	WHEN TYPE_COUNTY =  'Special city' or TYPE_COUNTY = 'Special City' OR TYPE_COUNTY = 'Special Island Authorithy' OR TYPE_COUNTY = 'special municipality' or TYPE_COUNTY = 'Special municipality' or TYPE_COUNTY = 'Special Municipality' 
	or TYPE_COUNTY = 'Special region' OR TYPE_COUNTY = 'Special self-governing city' or type_county like '%District with special%' OR TYPE_COUNTY = 'Special self-governing province' THEN '45'
	WHEN TYPE_COUNTY =  'state' or TYPE_COUNTY = 'State' THEN '46'
	WHEN TYPE_COUNTY =  'Territorial unit' OR TYPE_COUNTY = 'Territory' THEN '47'
	WHEN TYPE_COUNTY =  'Town' OR TYPE_COUNTY = 'Town council' THEN '48'
	WHEN TYPE_COUNTY =  'Union territory' THEN '49'
	WHEN TYPE_COUNTY =  'Unitary authority' THEN '50'
	WHEN TYPE_COUNTY =  'Urban community' THEN '51'
	WHEN TYPE_COUNTY =  'Voivodship' THEN '52'
	WHEN TYPE_COUNTY =  'ward' THEN '53'
	WHEN TYPE_COUNTY =  'Zone' THEN '54'
	ELSE '55'
	END AS INTEGER ) AS LOCATION_TYPE , 
NAME_COUNTY  AS NAME_EN,
NOW() AS CREATED_ON, 0 AS CREATED_BY, NOW() AS UPDATED_ON, 0 AS UPDATED_BY, 0.1 AS VERSION,
TYPE_COUNTY AS DESCRIPTION
FROM t_mapping_province TMP 

SELECT 4998 - 4726 FROM T_MST_LOCATION

SELECT * FROM t_mapping_province
SELECT * FROM T_MST_LOCATION WHERE LOCATION_ALPHA_CODE = 'ID' AND LOCATION_TYPE = 3
SELECT * FROM T_MST_LOCATION WHERE PARENT_ID =  129
SELECT * FROM T_MST_LOCATION WHERE LOCATION_NUMERIC_CODE <> '-1'
ALTER TABLE T_MST_LOCATION ADD  column DESCRIPTION varchar(100) 

SELECT cast((SELECT max(ID) AS A FROM t_mst_location 
WHERE LOCATION_ALPHA_CODE = TMP.ID_COUNTRY AND LOCATION_NUMERIC_CODE = '-1') as INTEGER) as parent_id,
*
FROM t_mapping_county TMP where id_country = 'ID'

SELECT * FROM t_mapping_county where id_country = 'ID' and name_county like '%%' AND PARENT_COUNTY = 'JT'
 
SELECT * FROM ( SELECT 
(CAST((SELECT ID AS A FROM (SELECT COUNTRY.LOCATION_ALPHA_CODE AS COUNTRY_ID, PROVINCE.ID, PROVINCE.LOCATION_NUMERIC_CODE, PROVINCE.LOCATION_ALPHA_CODE, 
PROVINCE.LOCATION_TYPE, PROVINCE.NAME_EN, PROVINCE.DESCRIPTION FROM t_mst_location PROVINCE INNER JOIN T_MST_LOCATION COUNTRY ON PROVINCE.PARENT_ID = COUNTRY.ID  
WHERE PROVINCE.LOCATION_NUMERIC_CODE = '-1'  /* AND  COUNTRY.LOCATION_ALPHA_CODE = 'ID' */ ) MST_LOCATION
WHERE MST_LOCATION.COUNTRY_ID = M_COUNTY.ID_COUNTRY AND LOCATION_ALPHA_CODE = M_COUNTY.PARENT_COUNTY AND LOCATION_NUMERIC_CODE = '-1'  ) AS INTEGER)) as PARENT_ID,

* FROM t_mapping_county M_COUNTY INNER JOIN
(SELECT COUNTRY.LOCATION_ALPHA_CODE AS COUNTRY_ID, PROVINCE.ID, PROVINCE.LOCATION_NUMERIC_CODE, PROVINCE.LOCATION_ALPHA_CODE, 
PROVINCE.LOCATION_TYPE, PROVINCE.NAME_EN, PROVINCE.DESCRIPTION 
FROM t_mst_location PROVINCE INNER JOIN T_MST_LOCATION COUNTRY ON PROVINCE.PARENT_ID = COUNTRY.ID  
WHERE PROVINCE.LOCATION_NUMERIC_CODE = '-1'  /* AND  COUNTRY.LOCATION_ALPHA_CODE = 'ID' */ ) MST_LOCATION
ON M_COUNTY.ID_COUNTRY = 'ID' AND MST_LOCATION.COUNTRY_ID = 'ID' /*MST_LOCATION.COUNTRY_ID*/ AND M_COUNTY.PARENT_COUNTY = MST_LOCATION.LOCATION_ALPHA_CODE ) RESULT_MAPPING



SELECT * FROM ( SELECT 
(CAST((SELECT ID AS A FROM (SELECT COUNTRY.LOCATION_ALPHA_CODE AS COUNTRY_ID, PROVINCE.ID, PROVINCE.LOCATION_NUMERIC_CODE, PROVINCE.LOCATION_ALPHA_CODE, 
PROVINCE.LOCATION_TYPE, PROVINCE.NAME_EN, PROVINCE.DESCRIPTION FROM t_mst_location PROVINCE INNER JOIN T_MST_LOCATION COUNTRY ON PROVINCE.PARENT_ID = COUNTRY.ID  
WHERE PROVINCE.LOCATION_NUMERIC_CODE = '-1'  /* AND  COUNTRY.LOCATION_ALPHA_CODE = 'ID' */ ) MST_LOCATION
WHERE MST_LOCATION.COUNTRY_ID = M_COUNTY.ID_COUNTRY AND LOCATION_ALPHA_CODE = M_COUNTY.PARENT_COUNTY AND LOCATION_NUMERIC_CODE = '-1'  ) AS INTEGER)) as PARENT_ID,

* FROM t_mapping_county M_COUNTY INNER JOIN T_MST_LOCATION  MST_LOCATION
ON MST_LOCATION.LOCATION_ALPHA_CODE = 'ID' 
AND MST_LOCATION.LOCATION_TYPE = 3 
AND M_COUNTY.ID_COUNTRY = 'ID' /*MST_LOCATION.COUNTRY_ID*/ 
AND M_COUNTY.PARENT_COUNTY IS NULL
AND M_COUNTY.ID_COUNTRY = MST_LOCATION.LOCATION_ALPHA_CODE ) RESULT_MAPPING


SELECT * FROM t_mapping_county PROVINCE WHERE ID_COUNTRY = 'ID' 
SELECT * FROM T_MST_LOCATION WHERE LOCATION_TYPE = 3 


WHERE RESULT_MAPPING.PARENT_ID = '1936'

SELECT * FROM T_MAPPING_COUNTY WHERE  ID_COUNTRY = 'ID' AND NAME_COUNTY LIKE '%tegal%'-- 1936
SELECT * FROM T_MST_LOCATION WHERE LOCATION_ALPHA_CODE = 'JT'

SELECT * FROM T_MST_LOCATION WHERE ID = 1959 AND LOCATION
SELECT * FROM T_MAPPING_COUNTY WHERE ID_COUNTRY = 'ID' AND LOCAL_CODE IS NOT NULL AND PARENT_COUNTY IS NOT NULL
SELECT * FROM t_mst_location 
WHERE LOCATION_ALPHA_CODE = 'ID' 
AND LOCATION_NUMERIC_CODE = '-1' 

SELECT * FROM
(SELECT COUNTRY.LOCATION_ALPHA_CODE AS COUNTRY_ID, PROVINCE.ID, PROVINCE.LOCATION_NUMERIC_CODE, PROVINCE.LOCATION_ALPHA_CODE, 
PROVINCE.LOCATION_TYPE, PROVINCE.NAME_EN, PROVINCE.DESCRIPTION 
FROM t_mst_location PROVINCE INNER JOIN T_MST_LOCATION COUNTRY ON PROVINCE.PARENT_ID = COUNTRY.ID  
WHERE PROVINCE.LOCATION_NUMERIC_CODE = '-1'  /* AND  COUNTRY.LOCATION_ALPHA_CODE = 'ID' */ ) MST_LOCATION
WHERE LOCATION_ALPHA_CODE = 'ID'

SELECT * FROM T_MST_LOCATION WHERE LOCATION_ALPHA_CODE = 'ID'


